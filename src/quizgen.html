<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <title>Quiz Generation</title>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <!-- Menu -->
        <div class="menu">
          <a href="index.html">Home</a>
          <a href="calendar.html">Calendar</a>
          <a href="quizgen.html">Quiz</a>
        </div>
      </div>

      <!-- Center: Title -->
      <div class="header-center">
        <h1 class="header-title">Study Buddy</h1>
      </div>

      <!-- Right: Notification Bell and Google Sign-In/Out -->
      <div class="header-right">
        <!-- Notification Bell -->
        <div
          id="notification-container"
          style="position: relative; margin-right: 15px"
        >
          <button id="notification-bell" class="notification-bell">
            <img
              src="https://cdn-icons-png.flaticon.com/512/1827/1827392.png"
              alt="Bell Icon"
            />
            <span
              id="notification-badge"
              class="notification-badge"
              style="display: none"
              >0</span
            >
          </button>
          <div
            id="notification-dropdown"
            class="notification-dropdown"
            style="display: none"
          >
            <ul id="notification-list" class="notification-list"></ul>
            <button id="clear-notifications" class="clear-notifications">
              Clear All
            </button>
          </div>
        </div>

        <!-- Google Sign-In/Out -->
        <div id="auth-controls" style="text-align: right">
          <!-- Sign In Button -->
          <button
            id="sign-in-button"
            class="google-button sign-in"
            onclick="handleSignInClick()"
            style="
              display: block;
              padding: 8px 16px;
              font-size: 14px;
              border-radius: 6px;
            "
          >
            <img
              src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
              alt="Google Logo"
              style="vertical-align: middle; margin-right: 8px"
            />
            Sign in with Google
          </button>

          <!-- User Name -->
          <span
            id="user-name"
            style="
              display: none;
              font-weight: bold;
              font-size: 14px;
              color: #333;
              margin-bottom: 5px;
              display: block;
            "
          >
          </span>

          <!-- Sign Out Button -->
          <button
            id="sign-out-button"
            class="google-button sign-out"
            onclick="handleSignOutClick()"
            style="
              display: none;
              padding: 8px 16px;
              font-size: 14px;
              border-radius: 6px;
            "
          >
            Sign Out
          </button>
        </div>
      </div>
    </header>

    <div class="options">
      <div class="quiz-option">
        <input
          id="quiz-topic-textbox"
          type="text"
          placeholder="Type topic to create quiz about here"
        />
      </div>
      <button class="generate-quiz-button">Generate Quiz</button>
    </div>

    <div class="error-msg-position">
      <div class="error-msg">Error: Please enter a topic</div>
      <div class="error-msg" id="question-not-answered">
        Error: Not all questions answered
      </div>
      <div class="error-msg" id="quiz-already-submitted">
        Error: Quiz already submitted. Please create a new one
      </div>
    </div>

    <section class="quiz-section">
      <div class="quiz-score-position">
        <div class="quiz-score"></div>
      </div>

      <div class="loader-position">
        <div class="loader">
          <img src="/public/duck-walking.gif" id="duck-gif" />
          <h3>Generating quiz...</h3>
        </div>
      </div>

      <div class="quiz-position">
        <div class="quiz">
          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a1"
                name="q1"
                onclick="setUserAnswer(0, 'a')"
              />
              <label id="option-a" for="a1"></label>

              <input
                type="radio"
                class="option"
                id="b1"
                name="q1"
                onclick="setUserAnswer(0, 'b')"
              />
              <label id="option-b" for="b1"></label>

              <input
                type="radio"
                class="option"
                id="c1"
                name="q1"
                onclick="setUserAnswer(0, 'c')"
              />
              <label id="option-c" for="c1"></label>

              <input
                type="radio"
                class="option"
                id="d1"
                name="q1"
                onclick="setUserAnswer(0, 'd')"
              />
              <label id="option-d" for="d1"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a2"
                name="q2"
                onclick="setUserAnswer(1, 'a')"
              />
              <label id="option-a" for="a2"></label>

              <input
                type="radio"
                class="option"
                id="b2"
                name="q2"
                onclick="setUserAnswer(1, 'b')"
              />
              <label id="option-b" for="b2"></label>

              <input
                type="radio"
                class="option"
                id="c2"
                name="q2"
                onclick="setUserAnswer(1, 'c')"
              />
              <label id="option-c" for="c2"></label>

              <input
                type="radio"
                class="option"
                id="d2"
                name="q2"
                onclick="setUserAnswer(1, 'd')"
              />
              <label id="option-d" for="d2"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a3"
                name="q3"
                onclick="setUserAnswer(2, 'a')"
              />
              <label id="option-a" for="a3"></label>

              <input
                type="radio"
                class="option"
                id="b3"
                name="q3"
                onclick="setUserAnswer(2, 'b')"
              />
              <label id="option-b" for="b3"></label>

              <input
                type="radio"
                class="option"
                id="c3"
                name="q3"
                onclick="setUserAnswer(2, 'c')"
              />
              <label id="option-c" for="c3"></label>

              <input
                type="radio"
                class="option"
                id="d3"
                name="q3"
                onclick="setUserAnswer(2, 'd')"
              />
              <label id="option-d" for="d3"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a4"
                name="q4"
                onclick="setUserAnswer(3, 'a')"
              />
              <label id="option-a" for="a4"></label>

              <input
                type="radio"
                class="option"
                id="b4"
                name="q4"
                onclick="setUserAnswer(3, 'b')"
              />
              <label id="option-b" for="b4"></label>

              <input
                type="radio"
                class="option"
                id="c4"
                name="q4"
                onclick="setUserAnswer(3, 'c')"
              />
              <label id="option-c" for="c4"></label>

              <input
                type="radio"
                class="option"
                id="d4"
                name="q4"
                onclick="setUserAnswer(3, 'd')"
              />
              <label id="option-d" for="d4"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a5"
                name="q5"
                onclick="setUserAnswer(4, 'a')"
              />
              <label id="option-a" for="a5"></label>

              <input
                type="radio"
                class="option"
                id="b5"
                name="q5"
                onclick="setUserAnswer(4, 'b')"
              />
              <label id="option-b" for="b5"></label>

              <input
                type="radio"
                class="option"
                id="c5"
                name="q5"
                onclick="setUserAnswer(4, 'c')"
              />
              <label id="option-c" for="c5"></label>

              <input
                type="radio"
                class="option"
                id="d5"
                name="q5"
                onclick="setUserAnswer(4, 'd')"
              />
              <label id="option-d" for="d5"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a6"
                name="q6"
                onclick="setUserAnswer(5, 'a')"
              />
              <label id="option-a" for="a6"></label>

              <input
                type="radio"
                class="option"
                id="b6"
                name="q6"
                onclick="setUserAnswer(5, 'b')"
              />
              <label id="option-b" for="b6"></label>

              <input
                type="radio"
                class="option"
                id="c6"
                name="q6"
                onclick="setUserAnswer(5, 'c')"
              />
              <label id="option-c" for="c6"></label>

              <input
                type="radio"
                class="option"
                id="d6"
                name="q6"
                onclick="setUserAnswer(5, 'd')"
              />
              <label id="option-d" for="d6"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a7"
                name="q7"
                onclick="setUserAnswer(6, 'a')"
              />
              <label id="option-a" for="a7"></label>

              <input
                type="radio"
                class="option"
                id="b7"
                name="q7"
                onclick="setUserAnswer(6, 'b')"
              />
              <label id="option-b" for="b7"></label>

              <input
                type="radio"
                class="option"
                id="c7"
                name="q7"
                onclick="setUserAnswer(6, 'c')"
              />
              <label id="option-c" for="c7"></label>

              <input
                type="radio"
                class="option"
                id="d7"
                name="q7"
                onclick="setUserAnswer(6, 'd')"
              />
              <label id="option-d" for="d7"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a8"
                name="q8"
                onclick="setUserAnswer(7, 'a')"
              />
              <label id="option-a" for="a8"></label>

              <input
                type="radio"
                class="option"
                id="b8"
                name="q8"
                onclick="setUserAnswer(7, 'b')"
              />
              <label id="option-b" for="b8"></label>

              <input
                type="radio"
                class="option"
                id="c8"
                name="q8"
                onclick="setUserAnswer(7, 'c')"
              />
              <label id="option-c" for="c8"></label>

              <input
                type="radio"
                class="option"
                id="d8"
                name="q8"
                onclick="setUserAnswer(7, 'd')"
              />
              <label id="option-d" for="d8"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a9"
                name="q9"
                onclick="setUserAnswer(8, 'a')"
              />
              <label id="option-a" for="a9"></label>

              <input
                type="radio"
                class="option"
                id="b9"
                name="q9"
                onclick="setUserAnswer(8, 'b')"
              />
              <label id="option-b" for="b9"></label>

              <input
                type="radio"
                class="option"
                id="c9"
                name="q9"
                onclick="setUserAnswer(8, 'c')"
              />
              <label id="option-c" for="c9"></label>

              <input
                type="radio"
                class="option"
                id="d9"
                name="q9"
                onclick="setUserAnswer(8, 'd')"
              />
              <label id="option-d" for="d9"></label>
            </div>
          </div>

          <div class="quiz-question-card">
            <div class="question"></div>

            <div class="multiple-choice-options">
              <input
                type="radio"
                class="option"
                id="a10"
                name="q10"
                onclick="setUserAnswer(9, 'a')"
              />
              <label id="option-a" for="a10"></label>

              <input
                type="radio"
                class="option"
                id="b10"
                name="q10"
                onclick="setUserAnswer(9, 'b')"
              />
              <label id="option-b" for="b10"></label>

              <input
                type="radio"
                class="option"
                id="c10"
                name="q10"
                onclick="setUserAnswer(9, 'c')"
              />
              <label id="option-c" for="c10"></label>

              <input
                type="radio"
                class="option"
                id="d10"
                name="q10"
                onclick="setUserAnswer(9, 'd')"
              />
              <label id="option-d" for="d10"></label>
            </div>
          </div>
        </div>
      </div>

      <a href="#top-of-page" class="submit-button-go-to-part">
        <button class="quiz-submit-button">Submit</button>
      </a>
    </section>

    <section>
      <div class="quiz-history-position">
        <table id="quiz-history">
          <th>Quiz History</th>
        </table>
        <button class="clear-quiz-history-button">Clear History</button>
      </div>
    </section>
    <script type="module" src="./User.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        fetch("application.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("shared-content").innerHTML = html;
          })
          .catch((err) => console.error("Failed to load shared content:", err));
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        try {
          const response = await fetch("application.html");
          const html = await response.text();
          document.getElementById("shared-content").innerHTML = html;
          await User.loadState();
          await User.initializeUser(); // Wait until user state is fully initialized
        } catch (err) {
          console.error("Error initializing page:", err);
        }
      });
    </script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
    <script type="module" src="quizscripts.js"></script>
  </body>
</html>
